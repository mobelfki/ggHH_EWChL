\documentclass[paper]{JHEP3}
\usepackage{amsmath,amssymb,enumerate,url}
\usepackage{xspace}
\bibliographystyle{JHEP}

%%%%%%%%%% Start TeXmacs macros
\newcommand{\tmtextit}[1]{{\itshape{#1}}}
\newcommand{\tmtexttt}[1]{{\ttfamily{#1}}}
\newenvironment{enumeratenumeric}{\begin{enumerate}[1.] }{\end{enumerate}}
\newcommand\sss{\mathchoice%
{\displaystyle}%
{\scriptstyle}%
{\scriptscriptstyle}%
{\scriptscriptstyle}%
}

\newcommand\as{\alpha_{\sss\rm S}}
\newcommand\POWHEG{{\tt POWHEG}}
\newcommand\POWHEGBOX{{\tt POWHEG BOX}}
\newcommand\POWHEGBOXV{{\tt POWHEG-BOX-V2}}
\newcommand\POWHEGBOXRES{{\tt POWHEG-BOX-RES}}
\newcommand\HERWIG{{\tt HERWIG}}
\newcommand\PYTHIA{{\tt PYTHIA}}
\newcommand\MCatNLO{{\tt MC@NLO}}
\newcommand\ftapprox{FT$_{\mathrm{approx}}$\xspace}

\newcommand\kt{k_{\sss\rm T}}
\newcommand\pthh{\ensuremath{p_{T}^{\mathrm{hh}}}\xspace}
\newcommand\pt{p_{\sss\rm T}}
\newcommand\LambdaQCD{\Lambda_{\scriptscriptstyle QCD}}
%%%%%%%%%% End TeXmacs macros


\title{The POWHEG BOX V2 user manual:\\
  double Higgs boson production with variations of the Higgs self-coupling} \vfill

\author{G.~Heinrich\\ 
  Max-Planck Institut f{\"u}r Physik, F\"ohringer 6, D-80805 Munich, Germany\\
  E-mail: \email{gudrun@mpp.mpg.de}
}

\author{S.~P.~Jones \\ 
  Max-Planck Institut f{\"u}r Physik, F\"ohringer 6, D-80805 Munich, Germany\\
  E-mail: \email{sjones@mpp.mpg.de}
}

\author{M.~Kerner \\ 
  Max-Planck Institut f{\"u}r Physik, F\"ohringer 6, D-80805 Munich, Germany\\
  E-mail: \email{kerner@mpp.mpg.de}
}


\author{G.~Luisoni\\
  Theoretical Physics Department, CERN, CH-1211 Geneva, Switzerland,\\
  E-mail: \email{gionata.luisoni@cern.ch}
}
\vskip -0.5truecm

\keywords{POWHEG, Shower Monte Carlo, NLO}

\abstract{This note documents the use of the package \POWHEGBOXV{} for
  the production of a Higgs boson pair by gluon fusion. The code
  allows to produce NLO results matched to parton shower for $HH$
  production in the Standard Model with full mass dependence, and also
  in the Higgs effective field theory (HEFT) approximation, in the
  so-called Born-improved HEFT approximation, and in the \ftapprox
  scheme.}

\preprint{\today\\ {\tt POWHEG BOX RES} 1.0}

\begin{document}


\section{Introduction}

The \POWHEGBOX{} program is a framework for implementing NLO
calculations in shower Monte Carlo programs according to the \POWHEG{}
method. An explanation of the method and a discussion of how the code
is organized can be found in
refs.~\cite{Nason:2004rx,Frixione:2007vw,Alioli:2010xd,Jezo:2015aia}.
The code is distributed according to the ``MCNET GUIDELINES for Event
Generator Authors and Users'' and can be found at the web page
%
\begin{center}
 \url{http://powhegbox.mib.infn.it}
\end{center}
%
In this manual, we describe the \POWHEG{} implementation of Higgs
boson pair production in gluon fusion, as described in
ref.~\cite{Heinrich:2017kxx}, based on the calculation reported in
refs.~\cite{Borowka:2016ehy,Borowka:2016ypz}.  This document describes
the input parameters that are specific to this implementation. The
parameters that are common to all \POWHEGBOX{} processes can be found
in the manual in the \POWHEGBOXV{}/{\tt Docs} directory.

The code can be found in the {\tt HH} directory under {\tt
  User-Processes-V2}, and can be used to generate NLO+PS QCD
corrections to Higgs boson pair production at hadronic colliders. An
example input card ({\tt powheg.input-save}) and a run script ({\tt
  run.sh}) are provided in the {\tt testrun} folder accompanying the
code.

\section{Running modes}
The code contains the amplitudes for both, the full Standard Model
(SM), for which $HH$-production is a loop-induced process, and the
Higgs Effective Field Theory (HEFT), where the Higgs boson couples
directly to gluons and the top-quark is integrated out ($m_t\to\infty$
limit).  This allows to run the code in four different modes by
changing the flag {\tt mtdep} in the \POWHEGBOX{} run card. The
possible choices and the corresponding calculations are the following:
\begin{description}
 \item[{\tt mtdep=0}:]{computation using basic HEFT. All amplitudes
   are computed in the limit of an inifinitely large top quark mass
   ($m_t\to\infty$).}
 \item[{\tt mtdep=1}:]{computation using Born-improved HEFT. In this
   approximation the fixed order part is computed at NLO in the HEFT
   and reweighted pointwise in the phase-space by the Born matrix
   element with full mass dependence.}
 \item[{\tt mtdep=2}:]{computation in the approximation \ftapprox. In
   this approximation the matrix element for the the Born and the real
   radiation contributions are computed with full mass dependence
   (using matrix elements generated by {\tt
     GoSam}~\cite{Cullen:2014yla}), whereas the virtual part is
   computed as in the Born-improved HEFT. }
 \item[{\tt mtdep=3}:]{computation in the full SM. All the matrix
   elements are computed using the full top-quark mass dependence.}
\end{description}

The {\tt run.sh} script in the {\tt testrun} folder allows to quickly
start some test runs. By simply typing {\tt ./run.sh} a menu with the
various running modes is shown. In all cases the code goes through all
the various steps (parallelstages) of the calculation, from the
generation of the ({\tt MINT}) grid to the production of LHE files.

\section{Running in the full SM ({\tt mtdep=3})}
The 2-loop virtual amplitudes in the full SM are computed via a grid
which encodes the dependence of the virtual 2-loop amplitude on the
kinematic invariants $\hat{s}$ and
$\hat{t}$~\cite{Heinrich:2017kxx}. Please note that the numerical
values $m_H=125$\,GeV and $m_t=173$\,GeV are {\bf hardcoded} in this
grid and therefore should not be changed in the {\tt mtdep=3} mode.
The grid is generated using a python code and, in the newest version
(after revision number 3507), the code is directly interfaced to the
\POWHEGBOX{} fortran code. The procedure for the computation with full
top quark mass dependence is similar to the one for the other running
modes. However, in order for the grid to be found by the code, the
files ({\tt events.cdf, createdgrid.py, Virt\_full\_cHHH\_$\lbrace$-1.0,0.0,1.0$\rbrace$.grid}) from the
folder {\tt Virtual} need to be copied into the local folder where the
code is run. Instead of copying the files, we suggest to create a
symbolic link of the needed files. Assuming the code is run from a
subfolder of the process folder, the link can be created as follows:
\begin{description}
\item{\tt ln -s ../Virtual/events.cdf events.cdf}
\item{\tt ln -s ../Virtual/creategrid.py creategrid.py}
\item{\tt for grid in ../Virtual/Virt\_full\_cHHH\_*.grid; do ln -s \$grid \$$\lbrace$grid\#\#*/$\rbrace$; done}
\end{description}
Once the links are in place, the code can be run with {\tt mtdep=3} as
usual. To ensure that the linked files are found, we recommend to add the run subfolder to {\tt PYTHONPATH}. The python code {\tt creategrid.py} will then combine the virtual grids generated with the three values of $c_{hhh} = -1,0,1$ to produce a new file {\tt Virt\_full.grid} suited to the value of {\tt cHHH} chosen in the {\tt powheg.input} file.

\section{Physical input parameters}

The bottom quark is considered massless in all four modes. The Higgs
bosons are generated on-shell with zero width. A decay can be attached
through the parton shower in the narrow-width approximation, however
the decay is by default switched off (see the {\tt hdecaymode} flag in the
example {\tt powheg.input-save} input card).

The masses of the Higgs boson and the top quark are set by default to
$m_h=125$\,GeV, $m_t=173$\,GeV, respectively, whereas their widths
have been set to zero. The full SM 2-loop virtual contribution has
been computed with these values for the masses hardcoded. 
Therefore, although it is possible to change the values of $m_h$
and $m_t$ via the {\tt powheg.input-save} input card when running with
{\tt mtdep} set to $0$, $1$ or $2$, {\bf the values of the Higgs mass and
the top mass should be kept fixed at $m_h=125$\,GeV and $m_t=173$\,GeV
when running with {\tt mtdep = 3}.}

The \POWHEGBOX{} offers the possibility to use a damping factor of the
form~\cite{Alioli:2008tz,Alioli:2009je}
\begin{align}
  F=\frac{h^{2}}{(\pthh)^2+h^{2}}\,,
\end{align}
where \pthh is the transverse momentum of the Higgs boson pair, to
limit the amount of hard radiation which is exponentiated in the
Sudakov form factor. The default setting ($F\equiv1$), results in
quite hard tails for observables like
$\pthh$~\cite{Heinrich:2017kxx}. Changing the damping factor $F$ by
setting the flag {\tt hdamp}$(=h)$ to some finite value in the input
card brings the high transverse momentum tails back onto the fixed NLO
predictions. Varying {\tt hdamp} allows to assess shower untertainties
within the \POWHEG{} matching scheme. However, when choosing a value
for {\tt hdamp}, it is important not to cut into the Sudakov
regime. In fact, a too low value for {\tt hdamp} could spoil the
logarithmic accuracy of the prediction. For this reason we suggest not
to choose values for {\tt hdamp} below $250$.


\begin{thebibliography}{10}

  %\cite{Nason:2004rx}
\bibitem{Nason:2004rx}
  P.~Nason,
  ``A new method for combining NLO QCD with shower Monte Carlo algorithms,''
  JHEP {\bf 0411} (2004) 040
  [arXiv:hep-ph/0409146].
  %%CITATION = JHEPA,0411,040;%%

  %\cite{Frixione:2007vw}
\bibitem{Frixione:2007vw}
  S.~Frixione, P.~Nason and C.~Oleari,
  ``Matching NLO QCD computations with Parton Shower simulations: the POWHEG method,''
  JHEP {\bf 0711} (2007) 070
  [arXiv:0709.2092].
  %%CITATION = JHEPA,0711,070;%%

  %\cite{Alioli:2010xd}
\bibitem{Alioli:2010xd}
  S.~Alioli, P.~Nason, C.~Oleari and E.~Re,
  ``A general framework for implementing NLO calculations in shower Monte Carlo programs: the POWHEG BOX,''
  JHEP {\bf 1006} (2010) 043
  [arXiv:1002.2581].

  %\cite{Jezo:2015aia}
\bibitem{Jezo:2015aia}
  T.~Jezo and P.~Nason,
  ``On the Treatment of Resonances in Next-to-Leading Order Calculations Matched to a Parton Shower,''
  JHEP {\bf 1512} (2015) 065
  [arXiv:1509.09071].

  
%\cite{Cullen:2011ac}
%\bibitem{Cullen:2011ac}
%  G.~Cullen, N.~Greiner, G.~Heinrich, G.~Luisoni, P.~Mastrolia, G.~Ossola, T.~Reiter and F.~Tramontano,
%  ``Automated One-Loop Calculations with GoSam,''
%  Eur.\ Phys.\ J.\ C {\bf 72} (2012) 1889
%  [arXiv:1111.2034].

%\cite{Cullen:2014yla}
\bibitem{Cullen:2014yla}
  G.~Cullen {\it et al.},
  ``GoSam-2.0: a tool for automated one-loop calculations within the Standard Model and beyond,''
  Eur.\ Phys.\ J.\ C {\bf 74} (2014) no.8,  3001
  %doi:10.1140/epjc/s10052-014-3001-5
  [arXiv:1404.7096 [hep-ph]].

%\cite{Heinrich:2017kxx}
\bibitem{Heinrich:2017kxx}
  G.~Heinrich, S.~P.~Jones, M.~Kerner, G.~Luisoni and E.~Vryonidou,
  %``NLO predictions for Higgs boson pair production with full top quark mass dependence matched to parton showers,''
  [arXiv:1703.09252].  

\bibitem{Borowka:2016ehy}
  S.~Borowka, N.~Greiner, G.~Heinrich, S.~P.~Jones, M.~Kerner, J.~Schlenk, U.~Schubert and T.~Zirke,
  %``Higgs Boson Pair Production in Gluon Fusion at Next-to-Leading Order with Full Top-Quark Mass Dependence,''
  Phys.\ Rev.\ Lett.\  {\bf 117} (2016) no.1,  012001
   Erratum: [Phys.\ Rev.\ Lett.\  {\bf 117} (2016) no.7,  079901]
%  doi:10.1103/PhysRevLett.117.079901, 10.1103/PhysRevLett.117.012001
  [arXiv:1604.06447 [hep-ph]].

\bibitem{Borowka:2016ypz}
  S.~Borowka, N.~Greiner, G.~Heinrich, S.~P.~Jones, M.~Kerner, J.~Schlenk and T.~Zirke,
  %``Full top quark mass dependence in Higgs boson pair production at NLO,''
  JHEP {\bf 1610} (2016) 107
%  doi:10.1007/JHEP10(2016)107
  [arXiv:1608.04798 [hep-ph]].

%\cite{Alioli:2008tz}
\bibitem{Alioli:2008tz}
  S.~Alioli, P.~Nason, C.~Oleari and E.~Re,
  %``NLO Higgs boson production via gluon fusion matched with shower in POWHEG,''
  JHEP {\bf 0904} (2009) 002
  [arXiv:0812.0578].

  %\cite{Alioli:2009je}
\bibitem{Alioli:2009je}
  S.~Alioli, P.~Nason, C.~Oleari and E.~Re,
  ``NLO single-top production matched with shower in POWHEG: s- and t-channel contributions,''
  JHEP {\bf 0909} (2009) 111
   Erratum: [JHEP {\bf 1002} (2010) 011]
  [arXiv:0907.4076].
  
\end{thebibliography}

\end{document}





